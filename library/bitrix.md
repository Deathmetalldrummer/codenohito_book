Разработка на 1С-Битрикс
========================

_Содержание:_

* Настройка окружения


Настройка окружения
-------------------

Для работы с Битрикс на локальном хосте будем использовать виртуальную машину,
которая предлагается [на сайте Битрикса](https://www.1c-bitrix.ru/download/vmbitrix.php)
для VirtualBox.

Подробное описание установки и работы с ней есть [в официальном курсе](https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=37&CHAPTER_ID=08809&LESSON_PATH=3908.8809).

После развёртки виртуальной машины и первичной настройки (раздел «Запуск
виртуальной машины BitrixVM» курса), необходимо [Установить](https://www.virtualbox.org/manual/ch04.html#idm2096)
VirtualBox Guest Additions чтобы нормально работали shared folders, а также
полезно будет сделать следующие действия:

1. Настроить Host-only Adapter в качестве сетевого адаптера, чтобы ip-адрес
  сервера оставался одним и тем же. Может быть непросто для неопытного.
2. Добавить запись в /etc/hosts на локальном хосте алиас для виртуальной машины,
  вроде bitrix.dev, а созданным сайтам на этой машине давать алиасы вроде
  yoursite.bitrix.dev.

### Добавление сайта

Если добавить сайт на виртуальную машину грамотно, то впоследствии для начала
работы нужно будет только запустить виртуалку и сразу сайт будет доступен
по адресу типа 'https://yoursite.bitrix.dev', а работать с кодом можно будет
на локальном хосте всеми привычными инструментами.

* Создаём на локальном хосте директорию в которой будут храниться файлы приложения.

* Создаём в настройках виртуальной машины в VirtualBox shared folder, указывая
  путь до созданной нами директории, адекватное имя и не забываем чекнуть
	галочку Auto-mount.

* Запускаем виртуальную машину и логинимся под root'ом, попадая в интерактивный
  интерфейс настройки сервера (будь он неладен).

* В разделе 6 "Manage sites in the pool" добавляем сайт, выбирая пункт 1
  "Create Site" и вводим примерно вот такие данные:

    - site name: как и договаривались что-то вроде 'yoursite.bitrix.dev';
    - site type: 'kernel';
    - site encoding: 'UTF-8';
    - enable cron tasks: 'y';
    - путь до директории проекта, имя базы данных, пользователя и пароль
      можно оставить по-умолчанию, как предлагает система, а можно и задать,
      но главное — записать эти данные;

* Немного подождём завершения работы по созданию (проверить статус можно
  в разделе 5 "Background tasks in the pool").

* На локальном хосте добавляем в /etc/hosts алиас на ip виртуальной машины
  тот же, что и созданный site name, чтобы url сайта был удобным,
  типа 'https://yoursite.bitrix.dev';

* Заходим под пользователем bitrix чтобы создать символьную ссылку с нашей
  расшаренной директории до директории созданного сайта.
  Если site name был задан 'yoursite.bitrix.dev', а путь до директории оставлен
  по-умолчанию, то файлы сайта будут размещены в директории
  '/home/bitrix/ext_www/yoursite.bitrix.dev'. Её нужно удалить.
  Если shared folder было задано имя 'yoursitedir', то она будет доступна
  по пути '/media/sf_yoursitedir'.
  Тогда команда создания символьной ссылки будет такая:
  `ln -s /media/sf_yoursitedir /home/bitrix/ext_www/yoursite.bitrix.dev`.
  Теперь все файлы в этой директории на виртуальной машине синхронизируются
  с файлами на локальном хосте и работать с ними можно привычными инструментами.
